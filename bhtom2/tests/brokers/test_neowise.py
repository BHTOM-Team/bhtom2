from decimal import Decimal
from typing import List
from unittest.mock import patch

from django.test import TestCase
from bhtom2.brokers.neowise import NEOWISEBroker
from bhtom_base.bhtom_dataproducts.models import ReducedDatum
from bhtom_base.bhtom_targets.models import Target, TargetName

from bhtom2.brokers.bhtom_broker import LightcurveUpdateReport
from bhtom2.external_service.data_source_information import DataSource
from bhtom2.brokers.gaia_alerts import GaiaAlertsBroker

sample_response = """\                                                                               
\fixlen = T
\RowsRetrieved =               281
\ORIGIN  = 'IPAC Infrared Science Archive (IRSA), Caltech/JPL'
\SIMULATED_TABLE  = 'n'
\DATETIME= '2022-11-21 04:15:05'
\DataTag = 'ADS/IRSA.Gator#2022/1121/041505_24470'
\DATABASE= 'NEOWISE-R Single Exposure (L1b) Source Table (neowiser_p1bs_psd)'
\EQUINOX = 'J2000'
\SKYAREA = 'within 5 arcsec of  ra=90.26701 dec=-18.96770 Eq J2000 '
\StatusFile = '/workspace/TMP_Xqafve_24470/Gator/irsa/24470/log.24470.html'
\SQL     = 'WHERE (no constraints) 
\SQL     = 'SELECT (9 column names follow in next row.)'
\ 
\ ra (deg) 
\ ___ right ascension (J2000)
\ dec (deg) 
\ ___ declination (J2000)
\ clon 
\ ___ Right ascention in Sexagesimal format.
\ clat 
\ ___ Declination in Sexagesimal format.
\ mjd (mjdate) 
\ ___ modified Julian date of the mid-point of the observation of the frame
\ w1mpro (mag) 
\ ___ instrumental profile-fit photometry magnitude, band 1
\ w1sigmpro (mag) 
\ ___ instrumental profile-fit photometry flux uncertainty in mag units, band 1
\ w2mpro (mag) 
\ ___ instrumental profile-fit photometry magnitude, band 2
\ w2sigmpro (mag) 
\ ___ instrumental profile-fit photometry flux uncertainty in mag units, band 2
\ dist (arcsec) 
\ ___ Distance between the target position and each source in arcsec.
\ angle (deg) 
\ ___ Position Angle in degree.
\ 
|          ra|         dec|          clon|          clat|            mjd|  w1mpro| w1sigmpro|  w2mpro| w2sigmpro|           dist|       angle|
|      double|      double|          char|          char|         double|  double|    double|  double|    double|         double|      double|
|         deg|         deg|              |              |         mjdate|     mag|       mag|     mag|       mag|         arcsec|         deg|
|        null|        null|          null|          null|           null|    null|      null|    null|      null|           null|        null|
   90.2670085  -18.9676985   06h01m04.08s  -18d58m03.71s  59272.67500541   10.582      0.016   10.643      0.020        0.007529   316.598518 
   90.2670153  -18.9677029   06h01m04.08s  -18d58m03.73s  56926.32734194   10.837      0.021   10.879      0.022        0.020846   120.053070 
   90.2670088  -18.9677067   06h01m04.08s  -18d58m03.74s  57288.01395744   10.802      0.016   10.890      0.022        0.024396   189.613485 
   90.2670059  -18.9677063   06h01m04.08s  -18d58m03.74s  57819.21166165   10.792      0.018   10.877      0.024        0.026618   211.610502 
   90.2670039  -18.9677061   06h01m04.08s  -18d58m03.74s  57816.98514890   10.803      0.021   10.904      0.023        0.030271   223.401480 
   90.2670073  -18.9677083   06h01m04.08s  -18d58m03.75s  58019.93438700   10.801      0.018   10.910      0.021        0.031193   197.099885 
   90.2670010  -18.9677028   06h01m04.08s  -18d58m03.73s  58905.83021410   10.798      0.018   10.908      0.024        0.032236   251.790151 
   90.2670050  -18.9677081   06h01m04.08s  -18d58m03.75s  58750.59109020   10.808      0.016   10.902      0.020        0.033809   210.274956 
   90.2670086  -18.9677094   06h01m04.08s  -18d58m03.75s  56734.61027777   10.803      0.015   10.855      0.019        0.034226   188.017326 
   90.2670046  -18.9677088   06h01m04.08s  -18d58m03.75s  56926.59029468   10.758      0.024   10.892      0.021        0.036626   210.127325 
   90.2670189  -18.9677069   06h01m04.08s  -18d58m03.74s  58906.35344684   10.801      0.016   10.791      0.025        0.039241   129.344700 
   90.2670109  -18.9677117   06h01m04.08s  -18d58m03.76s  57656.03668649   10.797      0.021   10.881      0.023        0.042255   175.839273 
   90.2669986  -18.9677054   06h01m04.08s  -18d58m03.74s  56926.52458832   10.829      0.016   10.870      0.020        0.043358   243.394576 
   90.2670035  -18.9677115   06h01m04.08s  -18d58m03.76s  57288.99789899   10.801      0.017   10.832      0.021        0.046916   208.125714 
   90.2670141  -18.9677127   06h01m04.08s  -18d58m03.77s  58019.27974267   10.793      0.017   10.905      0.021        0.047814   163.022290 
   90.2670062  -18.9677130   06h01m04.08s  -18d58m03.77s  57817.31253601   10.809      0.017   10.877      0.023        0.048598   195.452712 
   90.2670124  -18.9677136   06h01m04.08s  -18d58m03.77s  58905.37243382   10.837      0.020   10.902      0.023        0.049655   170.525308 
   90.2670178  -18.9677132   06h01m04.08s  -18d58m03.77s  57093.79736053   10.833      0.017   10.858      0.021        0.054464   150.802501 
   90.2670239  -18.9677080   06h01m04.09s  -18d58m03.75s  57653.41644527   10.817      0.021   10.887      0.023        0.055410   121.324049 
   90.2670157  -18.9677146   06h01m04.08s  -18d58m03.77s  59115.86160321   10.716      0.017   10.809      0.020        0.056003   159.735230 
   90.2670123  -18.9677155   06h01m04.08s  -18d58m03.78s  57452.87531988   10.812      0.017   10.881      0.022        0.056340   172.011849 
   90.2670146  -18.9677153   06h01m04.08s  -18d58m03.78s  58177.64341074   10.798      0.017   10.857      0.025        0.057255   164.128029 
   90.2670013  -18.9677151   06h01m04.08s  -18d58m03.77s  58383.69495306   10.810      0.016   10.869      0.021        0.061931   208.584844 
   90.2670160  -18.9677163   06h01m04.08s  -18d58m03.78s  57288.14524307   10.805      0.016   10.866      0.019        0.062159   160.806425 
   90.2670015  -18.9676844   06h01m04.08s  -18d58m03.66s  58383.43327389   10.779      0.020   10.820      0.021        0.063214   332.738565 
   90.2670153  -18.9677170   06h01m04.08s  -18d58m03.78s  59115.07682081   10.745      0.020   10.798      0.021        0.063809   163.572561 
   90.2669952  -18.9676891   06h01m04.08s  -18d58m03.68s  59115.27304817   10.767      0.018   10.809      0.021        0.063883   307.910467 
   90.2669942  -18.9677099   06h01m04.08s  -18d58m03.76s  57288.80116155   10.790      0.017   10.872      0.024        0.064545   236.473219 
   90.2670148  -18.9677175   06h01m04.08s  -18d58m03.78s  57453.00647836   10.806      0.018   10.835      0.024        0.065056   165.458391 
   90.2670125  -18.9677183   06h01m04.08s  -18d58m03.79s  58750.72199339   10.770      0.018   10.890      0.024        0.066421   172.638492 
   90.2670101  -18.9677188   06h01m04.08s  -18d58m03.79s  57288.93231986   10.798      0.017   10.880      0.020        0.067689   179.711786 
   90.2670026  -18.9677175   06h01m04.08s  -18d58m03.78s  58384.34934215   10.837      0.017   10.870      0.020        0.067828   201.796311 
   90.2670121  -18.9677188   06h01m04.08s  -18d58m03.79s  58020.13074204   10.811      0.016   10.965      0.026        0.068037   173.969815 
   90.2670084  -18.9677190   06h01m04.08s  -18d58m03.79s  57817.11605282   10.814      0.019   10.892      0.021        0.068590   184.553314 
   90.2670047  -18.9677195   06h01m04.08s  -18d58m03.79s  57817.70550242   10.809      0.019   10.913      0.024        0.072474   194.415079 
   90.2670115  -18.9677201   06h01m04.08s  -18d58m03.79s  57655.05414376   10.801      0.018   10.899      0.021        0.072539   175.963057 
   90.2670074  -18.9677202   06h01m04.08s  -18d58m03.79s  57094.91373272   10.799      0.016   10.889      0.020        0.073252   186.940129 
   90.2670001  -18.9677183   06h01m04.08s  -18d58m03.79s  56735.00540703   10.804      0.016   10.908      0.022        0.074022   207.094703 
   90.2670128  -18.9677204   06h01m04.08s  -18d58m03.79s  59115.73082737   10.761      0.019   10.838      0.022        0.074086   172.604232 
   90.2670019  -18.9677192   06h01m04.08s  -18d58m03.79s  57093.66607507   10.828      0.020   10.915      0.022        0.074404   201.750416 
   90.2670185  -18.9677194   06h01m04.08s  -18d58m03.79s  57816.85411766   10.823      0.017   10.905      0.020        0.075600   157.493137 
   90.2670088  -18.9677210   06h01m04.08s  -18d58m03.80s  58177.05434106   10.814      0.018   10.883      0.021        0.075725   183.093261 
   90.2670288  -18.9677116   06h01m04.09s  -18d58m03.76s  58020.39267619   10.872      0.022   10.926      0.025        0.076408   123.122359 
   90.2669935  -18.9677145   06h01m04.08s  -18d58m03.77s  59479.71940639   10.450      0.017   10.577      0.018        0.076655   227.100406 
   90.2670285  -18.9677125   06h01m04.09s  -18d58m03.77s  58906.09189387   10.802      0.019   10.862      0.027        0.077391   125.544673 
   90.2669943  -18.9677156   06h01m04.08s  -18d58m03.78s  58750.98367247   10.796      0.019   10.852      0.022        0.077513   223.584278 
   90.2669907  -18.9676885   06h01m04.08s  -18d58m03.68s  57453.59630991   10.804      0.017   10.900      0.020        0.077635   302.213642 
   90.2669907  -18.9677115   06h01m04.08s  -18d58m03.76s  57653.15438295   10.827      0.019   10.944      0.027        0.077635   237.786350 
   90.2670062  -18.9677213   06h01m04.08s  -18d58m03.80s  57288.40755955   10.815      0.016   10.811      0.021        0.077756   189.576571 
   90.2669980  -18.9677188   06h01m04.08s  -18d58m03.79s  58751.37612736   10.786      0.017   10.900      0.022        0.079081   211.116838 
   90.2670117  -18.9677223   06h01m04.08s  -18d58m03.80s  57819.34269291   10.817      0.024   10.892      0.024        0.080502   175.876460 
   90.2669891  -18.9677113   06h01m04.08s  -18d58m03.76s  58020.06529037   10.827      0.017   10.942      0.023        0.081956   240.242842 
   90.2670069  -18.9677227   06h01m04.08s  -18d58m03.80s  58384.28389050   10.798      0.018   10.891      0.026        0.082416   187.358942 
   90.2670025  -18.9677218   06h01m04.08s  -18d58m03.80s  56926.45875461   10.822      0.017   10.894      0.022        0.082530   198.022615 
   90.2669891  -18.9677117   06h01m04.08s  -18d58m03.76s  58751.24522417   10.798      0.019   10.905      0.023        0.082702   239.376569 
   90.2670174  -18.9677219   06h01m04.08s  -18d58m03.80s  59114.74994490   10.733      0.016   10.851      0.020        0.082759   162.278604 
   90.2670264  -18.9677170   06h01m04.09s  -18d58m03.78s  57094.58532800   10.819      0.017   10.893      0.021        0.082816   137.625048 
   90.2669856  -18.9677005   06h01m04.08s  -18d58m03.72s  57820.06291891   10.799      0.019   10.887      0.022        0.083101   268.758685 
   90.2670074  -18.9677231   06h01m04.08s  -18d58m03.80s  57655.51268922   10.803      0.016   10.903      0.023        0.083611   186.075836 
   90.2670283  -18.9677157   06h01m04.09s  -18d58m03.78s  56926.19580193   10.790      0.020   10.861      0.022        0.084117   132.213744 
   90.2670204  -18.9677213   06h01m04.08s  -18d58m03.80s  59272.47890479   10.597      0.018   10.693      0.020        0.084454   155.214815 
   90.2670066  -18.9677233   06h01m04.08s  -18d58m03.80s  59273.32875905   10.612      0.015   10.679      0.018        0.084677   187.857158 
   90.2669979  -18.9677208   06h01m04.08s  -18d58m03.79s  56926.91920858   10.780      0.016   10.861      0.021        0.085455   208.817121 
   90.2670268  -18.9677177   06h01m04.09s  -18d58m03.78s  57288.60429689   10.798      0.016   10.930      0.020        0.085620   138.088365 
   90.2670070  -18.9677238   06h01m04.08s  -18d58m03.81s  58019.41064610   10.818      0.016   10.960      0.024        0.086280   186.797929 
   90.2670030  -18.9677232   06h01m04.08s  -18d58m03.80s  57094.51974895   10.810      0.019   10.884      0.024        0.086880   195.925624 
   90.2670327  -18.9677117   06h01m04.09s  -18d58m03.76s  58178.03612395   10.762      0.019   10.904      0.021        0.088014   118.590899 
   90.2669983  -18.9677219   06h01m04.08s  -18d58m03.80s  59272.80578161   10.602      0.016   10.688      0.021        0.088335   206.804638 
   90.2670125  -18.9677245   06h01m04.08s  -18d58m03.81s  57094.45404252   10.809      0.015   10.876      0.019        0.088602   174.488014 
   90.2670091  -18.9677247   06h01m04.08s  -18d58m03.81s  58019.60700113   10.819      0.016   10.903      0.022        0.088975   181.973561 
   90.2669998  -18.9677229   06h01m04.08s  -18d58m03.80s  58019.99983867   10.819      0.018   10.876      0.021        0.089451   202.842268 
   90.2670130  -18.9677250   06h01m04.08s  -18d58m03.81s  57453.33411976   10.817      0.019   10.868      0.024        0.090553   173.525533 
   90.2670191  -18.9677237   06h01m04.08s  -18d58m03.81s  58384.21843884   10.806      0.016   10.931      0.022        0.090762   160.043151 
   90.2670156  -18.9677247   06h01m04.08s  -18d58m03.81s  57289.26034336   10.788      0.021   10.862      0.023        0.090918   167.898428 
   90.2670116  -18.9677253   06h01m04.08s  -18d58m03.81s  58384.02208397   10.803      0.017   10.896      0.022        0.091229   176.577375 
   90.2670268  -18.9677198   06h01m04.09s  -18d58m03.79s  57453.20308866   10.822      0.017   10.887      0.023        0.091384   141.255966 
   90.2670155  -18.9677250   06h01m04.08s  -18d58m03.81s  56926.32721458   10.798      0.017   10.872      0.022        0.091951   168.247029 
   90.2670066  -18.9677256   06h01m04.08s  -18d58m03.81s  58384.02221133   10.851      0.021   10.851      0.024        0.092871   187.158920 
   90.2670025  -18.9677251   06h01m04.08s  -18d58m03.81s  56735.40040900   10.787      0.015   10.887      0.019        0.093883   195.779243 
   90.2669972  -18.9677232   06h01m04.08s  -18d58m03.80s  58751.83403378   10.786      0.017   10.949      0.022        0.094184   207.554045 
   90.2670213  -18.9677239   06h01m04.09s  -18d58m03.81s  58383.89130797   10.792      0.016   10.912      0.021        0.094234   155.909102 
   90.2670097  -18.9677263   06h01m04.08s  -18d58m03.81s  57817.83640634   10.805      0.016   10.913      0.026        0.094684   180.618053 
   90.2670271  -18.9677208   06h01m04.09s  -18d58m03.79s  58019.73790455   10.815      0.019   10.898      0.022        0.094834   142.135791 
   90.2670114  -18.9677264   06h01m04.08s  -18d58m03.82s  58751.04899671   10.824      0.016   10.914      0.020        0.095182   177.128973 
   90.2670238  -18.9677232   06h01m04.09s  -18d58m03.80s  58541.14524205   10.830      0.020   10.918      0.024        0.095825   150.640961 
   90.2670161  -18.9677262   06h01m04.08s  -18d58m03.81s  56735.86137196   10.807      0.016   10.861      0.021        0.096561   167.582609 
   90.2670129  -18.9677275   06h01m04.08s  -18d58m03.82s  59486.05917252   10.523      0.015   10.595      0.022        0.099501   174.304806 
   90.2670176  -18.9677267   06h01m04.08s  -18d58m03.82s  59479.32733353   10.433      0.015   10.537      0.018        0.099548   164.933768 
   90.2670182  -18.9677267   06h01m04.08s  -18d58m03.82s  59479.39265784   10.423      0.018   10.556      0.022        0.100069   163.804576 
   90.2670183  -18.9677268   06h01m04.08s  -18d58m03.82s  56926.72183479   10.811      0.017   10.856      0.022        0.100540   163.675470 
   90.2670117  -18.9677279   06h01m04.08s  -18d58m03.82s  58020.52357953   10.817      0.018   10.914      0.021        0.100587   176.702069 
   90.2669922  -18.9677225   06h01m04.08s  -18d58m03.80s  59480.11160723   10.451      0.020   10.537      0.025        0.101149   216.802190 
   90.2670055  -18.9677278   06h01m04.08s  -18d58m03.82s  57288.67000333   10.796      0.020   10.876      0.022        0.101242   188.703344 
   90.2670125  -18.9677282   06h01m04.08s  -18d58m03.82s  57094.38833616   10.814      0.018   10.843      0.025        0.101893   175.207597 
   90.2670176  -18.9677274   06h01m04.08s  -18d58m03.82s  58747.71236567   10.800      0.016   10.879      0.021        0.101986   165.301803 
   90.2670079  -18.9677283   06h01m04.08s  -18d58m03.82s  59115.33849979   10.722      0.016   10.822      0.021        0.102124   184.014194 
   90.2669900  -18.9677215   06h01m04.08s  -18d58m03.80s  58750.85276922   10.816      0.016   10.914      0.021        0.103091   221.338819 
   90.2669938  -18.9677243   06h01m04.08s  -18d58m03.81s  59486.12449684   10.509      0.018   10.630      0.021        0.103411   212.230114 
   90.2669935  -18.9677242   06h01m04.08s  -18d58m03.81s  58751.70313059   10.789      0.021   10.882      0.022        0.103640   212.813788 
   90.2669949  -18.9677250   06h01m04.08s  -18d58m03.81s  57817.24708407   10.812      0.018   10.904      0.033        0.103640   209.735176 
   90.2670195  -18.9677274   06h01m04.08s  -18d58m03.82s  57094.19134427   10.804      0.016   10.863      0.021        0.103822   161.846236 
   90.2670208  -18.9677271   06h01m04.08s  -18d58m03.82s  57453.98953059   10.799      0.017   10.886      0.019        0.104276   159.349334 
   90.2670139  -18.9677290   06h01m04.08s  -18d58m03.82s  58176.79253228   10.809      0.017   10.914      0.022        0.105223   172.752001 
   90.2670154  -18.9677289   06h01m04.08s  -18d58m03.82s  58541.79950285   10.802      0.016   10.915      0.020        0.105671   169.978966 
   90.2669968  -18.9677267   06h01m04.08s  -18d58m03.82s  58905.96099030   10.809      0.018   10.891      0.020        0.106117   205.057874 
   90.2670167  -18.9677291   06h01m04.08s  -18d58m03.82s  57819.34256553   10.833      0.019   10.920      0.021        0.107224   167.716211 
   90.2669913  -18.9677240   06h01m04.08s  -18d58m03.81s  59272.74045714   10.608      0.017   10.705      0.021        0.107312   216.384991 
   90.2670207  -18.9677281   06h01m04.08s  -18d58m03.82s  59479.00058487   10.449      0.016   10.508      0.019        0.107532   160.195692 
   90.2670313  -18.9677221   06h01m04.09s  -18d58m03.80s  58541.01446625   10.805      0.020   10.861      0.022        0.107663   137.651822 
   90.2670196  -18.9677285   06h01m04.08s  -18d58m03.82s  57652.17171292   10.817      0.016   10.899      0.022        0.107663   162.330608 
   90.2669978  -18.9677277   06h01m04.08s  -18d58m03.82s  59115.40382404   10.709      0.016   10.812      0.022        0.108014   202.612630 
   90.2670160  -18.9677296   06h01m04.08s  -18d58m03.83s  59115.53421788   10.728      0.020   10.837      0.025        0.108494   169.148257 
   90.2669856  -18.9677196   06h01m04.08s  -18d58m03.79s  56735.59790994   10.753      0.017   10.858      0.019        0.108971   229.655441 
   90.2669871  -18.9677213   06h01m04.08s  -18d58m03.80s  58383.95675968   10.803      0.018   10.911      0.021        0.109361   225.475586 
   90.2669786  -18.9677067   06h01m04.07s  -18d58m03.74s  58905.24153035   10.771      0.020   10.881      0.023        0.109577   257.285428 
   90.2670156  -18.9677300   06h01m04.08s  -18d58m03.83s  57655.18517495   10.827      0.016   10.885      0.021        0.109663   169.988663 
   90.2670018  -18.9677295   06h01m04.08s  -18d58m03.83s  59272.93655781   10.601      0.018   10.688      0.019        0.109792   194.728298 
   90.2670153  -18.9677304   06h01m04.08s  -18d58m03.83s  57094.25705068   10.800      0.017   10.875      0.026        0.110905   170.637551 
   90.2670063  -18.9677311   06h01m04.08s  -18d58m03.83s  57288.66987602   10.824      0.020   10.821      0.024        0.112679   186.419417 
   90.2670301  -18.9677250   06h01m04.09s  -18d58m03.81s  57820.19395020   11.662      0.020   11.752      0.036        0.113056   142.752666 
   90.2670308  -18.9677245   06h01m04.09s  -18d58m03.81s  57453.72746829   10.785      0.018   10.883      0.020        0.113098   141.239663 
   90.2669850  -18.9677207   06h01m04.08s  -18d58m03.79s  59273.13265844   10.607      0.016   10.671      0.020        0.113140   228.796547 
   90.2669926  -18.9677269   06h01m04.08s  -18d58m03.82s  58751.70325795   10.801      0.021   10.847      0.024        0.113515   211.454871 
   90.2669908  -18.9677258   06h01m04.08s  -18d58m03.81s  57819.80098378   10.824      0.022   10.886      0.020        0.113556   215.137043 
   90.2669879  -18.9677237   06h01m04.08s  -18d58m03.81s  58751.17939056   10.799      0.016   10.910      0.022        0.113764   221.407683 
   90.2669892  -18.9677248   06h01m04.08s  -18d58m03.81s  59272.34812807   10.599      0.016   10.662      0.021        0.113972   218.420369 
   90.2670073  -18.9677317   06h01m04.08s  -18d58m03.83s  59479.98083082   10.474      0.016   10.542      0.021        0.114509   184.605160 
   90.2670426  -18.9677079   06h01m04.09s  -18d58m03.75s  57453.26854052   10.785      0.017   10.902      0.021        0.114592   104.372509 
   90.2670031  -18.9677312   06h01m04.08s  -18d58m03.83s  59115.14176308   10.749      0.018   10.828      0.022        0.114756   191.812884 
   90.2669924  -18.9677272   06h01m04.08s  -18d58m03.82s  59479.85018225   10.429      0.017   10.533      0.021        0.114797   211.463493 
   90.2670181  -18.9677311   06h01m04.08s  -18d58m03.83s  58177.38160201   10.798      0.017   10.912      0.021        0.115290   166.163012 
   90.2670215  -18.9677304   06h01m04.09s  -18d58m03.83s  57817.44343988   10.791      0.021   10.873      0.022        0.116229   160.315380 
   90.2669846  -18.9677216   06h01m04.08s  -18d58m03.80s  57653.28541409   10.816      0.020   10.888      0.026        0.116310   228.037496 
   90.2670156  -18.9677320   06h01m04.08s  -18d58m03.84s  57655.90578267   10.808      0.017   10.889      0.024        0.116756   170.602851 
   90.2670255  -18.9677293   06h01m04.09s  -18d58m03.83s  56927.05074865   10.800      0.016   10.866      0.026        0.117963   153.421845 
   90.2670023  -18.9677320   06h01m04.08s  -18d58m03.84s  57819.67007986   10.827      0.018   10.904      0.021        0.118163   192.819888 
   90.2669840  -18.9677218   06h01m04.08s  -18d58m03.80s  59272.60968100   10.609      0.018   10.668      0.023        0.118283   228.439724 
   90.2669810  -18.9676818   06h01m04.08s  -18d58m03.65s  59114.61916897   10.727      0.020   10.818      0.020        0.118483   303.569019 
   90.2670175  -18.9677322   06h01m04.08s  -18d58m03.84s  57093.92864605   10.828      0.026   10.859      0.023        0.118682   167.577709 
   90.2670105  -18.9677332   06h01m04.08s  -18d58m03.84s  58384.41479381   10.804      0.015   10.894      0.025        0.119515   179.184020 
   90.2670183  -18.9677323   06h01m04.08s  -18d58m03.84s  56927.44536948   10.816      0.018   10.860      0.022        0.119673   166.341140 
   90.2669958  -18.9677307   06h01m04.08s  -18d58m03.83s  58906.02644208   10.792      0.017   10.926      0.022        0.120616   203.625798 
   90.2669988  -18.9677318   06h01m04.08s  -18d58m03.83s  57288.73558247   10.781      0.017   10.887      0.021        0.120655   198.421748 
   90.2670206  -18.9677320   06h01m04.08s  -18d58m03.84s  56927.31382878   10.810      0.017   10.924      0.024        0.120734   162.606120 
   90.2670332  -18.9677254   06h01m04.09s  -18d58m03.81s  56926.19567456   10.831      0.020   10.883      0.020        0.120812   139.179855 
   90.2670165  -18.9677330   06h01m04.08s  -18d58m03.84s  58751.57235476   10.807      0.018   10.863      0.024        0.120851   169.448186 
   90.2670032  -18.9677330   06h01m04.08s  -18d58m03.84s  57817.96743758   10.804      0.017   10.901      0.023        0.121046   191.027137 
   90.2669898  -18.9677277   06h01m04.08s  -18d58m03.82s  59273.06733402   10.610      0.017   10.649      0.025        0.121124   214.591907 
   90.2670265  -18.9677299   06h01m04.09s  -18d58m03.83s  57453.39969899   10.784      0.016   10.842      0.022        0.121436   152.441045 
   90.2670271  -18.9677296   06h01m04.09s  -18d58m03.83s  56734.74194505   10.800      0.018   10.919      0.021        0.121436   151.350699 
   90.2669833  -18.9677225   06h01m04.08s  -18d58m03.80s  57652.49922714   10.836      0.016   10.928      0.023        0.121747   228.296383 
   90.2669949  -18.9677309   06h01m04.08s  -18d58m03.83s  58906.48371373   10.780      0.016   10.902      0.020        0.122559   204.803502 
   90.2670402  -18.9677186   06h01m04.09s  -18d58m03.79s  58751.11444829   10.826      0.017   10.925      0.024        0.122713   123.074433 
   90.2670164  -18.9677339   06h01m04.08s  -18d58m03.84s  59478.86980898   10.445      0.015   10.552      0.018        0.123976   169.877097 
   90.2669883  -18.9677277   06h01m04.08s  -18d58m03.82s  58384.54569707   10.813      0.019   10.889      0.021        0.124091   216.533142 
   90.2670306  -18.9677289   06h01m04.09s  -18d58m03.82s  57817.50901919   10.813      0.016   10.859      0.022        0.125453   146.016136 
   90.2670146  -18.9677346   06h01m04.08s  -18d58m03.84s  57819.53904867   10.798      0.019   10.896      0.025        0.125529   172.833854 
   90.2669793  -18.9677198   06h01m04.08s  -18d58m03.79s  58906.09176650   10.787      0.020   10.906      0.020        0.126503   235.706733 
   90.2670218  -18.9677335   06h01m04.09s  -18d58m03.84s  58177.31614980   10.799      0.018   10.883      0.025        0.127099   161.576421 
   90.2670281  -18.9677312   06h01m04.09s  -18d58m03.83s  56735.26874168   10.783      0.015   10.891      0.026        0.128099   151.249583 
   90.2670178  -18.9677349   06h01m04.08s  -18d58m03.85s  57452.74428878   10.783      0.019   10.894      0.021        0.128430   168.065595 
   90.2670285  -18.9677315   06h01m04.09s  -18d58m03.83s  58176.92343670   10.818      0.018   10.885      0.022        0.129711   150.951675 
   90.2670193  -18.9677357   06h01m04.08s  -18d58m03.85s  58541.99585818   10.792      0.018   10.968      0.024        0.132378   166.160251 
   90.2670113  -18.9677368   06h01m04.08s  -18d58m03.85s  57819.73553185   10.816      0.016   10.926      0.023        0.132557   178.086578 
   90.2670156  -18.9677367   06h01m04.08s  -18d58m03.85s  57817.63992311   10.796      0.018   10.882      0.020        0.133480   171.788715 
   90.2670194  -18.9677361   06h01m04.08s  -18d58m03.85s  58177.51250642   10.783      0.020   10.895      0.019        0.133833   166.166197 
   90.2670492  -18.9677030   06h01m04.09s  -18d58m03.73s  57453.46527823   10.770      0.018   10.836      0.026        0.133904    94.626566 
   90.2670328  -18.9677310   06h01m04.09s  -18d58m03.83s  59272.87110603   10.629      0.019   10.670      0.019        0.135934   145.179519 
   90.2670198  -18.9677367   06h01m04.08s  -18d58m03.85s  56926.85337486   10.808      0.019   10.893      0.021        0.136282   165.827368 
   90.2670160  -18.9677375   06h01m04.08s  -18d58m03.85s  58020.26164546   10.793      0.018   10.884      0.022        0.136524   171.395715 
   90.2670075  -18.9677379   06h01m04.08s  -18d58m03.86s  56735.07124068   10.816      0.017   10.883      0.027        0.136697   183.569564 
   90.2669926  -18.9677345   06h01m04.08s  -18d58m03.84s  59479.26200926   10.444      0.017   10.559      0.020        0.137592   205.499397 
   90.2669820  -18.9677278   06h01m04.08s  -18d58m03.82s  57655.31607876   10.790      0.018   10.885      0.021        0.138209   223.606556 
   90.2670132  -18.9677383   06h01m04.08s  -18d58m03.86s  57655.64372027   10.809      0.016   10.874      0.022        0.138311   175.482204 
   90.2669877  -18.9677322   06h01m04.08s  -18d58m03.84s  57288.27640133   10.794      0.016   10.897      0.022        0.138584   213.222494 
   90.2670041  -18.9677381   06h01m04.08s  -18d58m03.86s  58383.82585637   10.802      0.019   10.897      0.023        0.138618   188.331584 
   90.2669838  -18.9677296   06h01m04.08s  -18d58m03.83s  58384.08753562   10.798      0.018   10.891      0.021        0.138959   219.931820 
   90.2670063  -18.9677387   06h01m04.08s  -18d58m03.86s  57655.31620609   10.822      0.019   10.918      0.021        0.139873   185.166403 
   90.2670176  -18.9677383   06h01m04.08s  -18d58m03.86s  57288.53871780   10.815      0.018   10.888      0.022        0.140278   169.371554 
   90.2670214  -18.9677375   06h01m04.09s  -18d58m03.85s  58541.34159667   10.789      0.020   10.911      0.022        0.140480   163.960410 
   90.2669798  -18.9677266   06h01m04.08s  -18d58m03.82s  57655.77475145   10.797      0.018   10.888      0.022        0.140514   227.035227 
   90.2669933  -18.9677363   06h01m04.08s  -18d58m03.85s  59273.00188228   10.620      0.015   10.685      0.020        0.142516   203.512649 
   90.2669845  -18.9677315   06h01m04.08s  -18d58m03.83s  57094.06005884   10.796      0.016   10.878      0.022        0.142814   217.436515 
   90.2669875  -18.9677336   06h01m04.08s  -18d58m03.84s  59115.07694817   10.730      0.021   10.837      0.021        0.143178   212.345361 
   90.2670252  -18.9677371   06h01m04.09s  -18d58m03.85s  57817.44356725   10.810      0.020   10.881      0.023        0.143244   158.820777 
   90.2670084  -18.9677401   06h01m04.08s  -18d58m03.86s  57817.57447117   10.821      0.018   10.908      0.024        0.144459   182.160959 
   90.2670178  -18.9677395   06h01m04.08s  -18d58m03.86s  57289.26021600   10.797      0.019   10.915      0.023        0.144655   169.422075 
   90.2670317  -18.9677346   06h01m04.09s  -18d58m03.84s  57288.86674073   10.769      0.017   10.909      0.027        0.144818   149.327248 
   90.2670175  -18.9677396   06h01m04.08s  -18d58m03.86s  56735.20290801   10.837      0.018   10.908      0.021        0.144818   169.845417 
   90.2670044  -18.9677399   06h01m04.08s  -18d58m03.86s  58384.15298723   10.818      0.017   10.922      0.024        0.144916   187.560680 
   90.2669853  -18.9677330   06h01m04.08s  -18d58m03.84s  58541.27614512   10.799      0.016   10.916      0.028        0.145566   215.292517 
   90.2670429  -18.9677259   06h01m04.09s  -18d58m03.81s  56735.59803730   10.796      0.018   10.860      0.024        0.145728   129.775140 
   90.2670273  -18.9677371   06h01m04.09s  -18d58m03.85s  58905.76476237   10.817      0.017   10.885      0.022        0.145955   156.203116 
   90.2670197  -18.9677395   06h01m04.08s  -18d58m03.86s  59115.20721465   10.743      0.018   10.846      0.021        0.145987   166.925639 
   90.2669914  -18.9677367   06h01m04.08s  -18d58m03.85s  58541.40692087   10.823      0.019   10.872      0.020        0.146504   205.608073 
   90.2670347  -18.9677335   06h01m04.09s  -18d58m03.84s  57094.65103438   10.814      0.016   10.872      0.023        0.147019   145.112762 
   90.2669811  -18.9677304   06h01m04.08s  -18d58m03.83s  58747.90859311   10.792      0.016   10.906      0.026        0.147179   221.956771 
   90.2669897  -18.9677362   06h01m04.08s  -18d58m03.85s  56735.72970463   10.788      0.015   10.862      0.020        0.147500   207.938101 
   90.2670165  -18.9677406   06h01m04.08s  -18d58m03.87s  58177.25069764   10.850      0.021   10.884      0.025        0.147820   171.390496 
   90.2670286  -18.9677371   06h01m04.09s  -18d58m03.85s  57453.26866789   10.811      0.019   10.857      0.021        0.147820   154.633182 
   90.2670216  -18.9677396   06h01m04.09s  -18d58m03.86s  57655.44710995   10.817      0.019   10.892      0.023        0.147916   164.516005 
   90.2669895  -18.9677363   06h01m04.08s  -18d58m03.85s  58019.86893529   10.807      0.016   10.889      0.024        0.148139   208.105515 
   90.2670130  -18.9677411   06h01m04.08s  -18d58m03.87s  56734.87361237   10.818      0.020   10.902      0.022        0.148298   176.051175 
   90.2670276  -18.9677378   06h01m04.09s  -18d58m03.86s  56926.98491493   10.817      0.021   10.851      0.023        0.148680   156.234824 
   90.2670015  -18.9677407   06h01m04.08s  -18d58m03.87s  57453.53073010   10.802      0.017   10.860      0.019        0.149346   191.172427 
   90.2670283  -18.9677379   06h01m04.09s  -18d58m03.86s  57817.37798795   10.822      0.017   10.874      0.022        0.149977   155.457058 
   90.2669809  -18.9677315   06h01m04.08s  -18d58m03.83s  58177.90521953   10.806      0.016   10.963      0.030        0.150574   221.142031 
   90.2669976  -18.9677403   06h01m04.08s  -18d58m03.87s  59480.11147992   10.469      0.019   10.587      0.022        0.151107   196.224211 
   90.2669774  -18.9677285   06h01m04.07s  -18d58m03.82s  58177.18524543   10.805      0.018   10.845      0.021        0.151138   227.248841 
   90.2670200  -18.9677411   06h01m04.08s  -18d58m03.87s  57094.78231988   10.800      0.018   10.881      0.022        0.151824   167.041917 
   90.2669820  -18.9677330   06h01m04.08s  -18d58m03.84s  58019.54154942   10.806      0.017   10.950      0.024        0.152321   218.744031 
   90.2670116  -18.9677423   06h01m04.08s  -18d58m03.87s  58905.50270071   10.804      0.024   10.931      0.024        0.152383   177.951333 
   90.2669862  -18.9677359   06h01m04.08s  -18d58m03.85s  59273.19798285   10.602      0.018   10.695      0.020        0.152538   212.085880 
   90.2669969  -18.9677406   06h01m04.08s  -18d58m03.87s  59479.52343369   10.436      0.019   10.602      0.022        0.152816   196.969055 
   90.2670343  -18.9677358   06h01m04.09s  -18d58m03.85s  56926.65612839   10.818      0.015   10.890      0.023        0.153156   147.302992 
   90.2669820  -18.9677335   06h01m04.08s  -18d58m03.84s  59479.58875791   10.455      0.016   10.546      0.019        0.153741   218.324158 
   90.2670010  -18.9677419   06h01m04.08s  -18d58m03.87s  57819.08063042   10.801      0.020   10.909      0.025        0.153925   191.482488 
   90.2669814  -18.9677334   06h01m04.08s  -18d58m03.84s  57652.82686868   10.833      0.020   10.849      0.023        0.154721   219.000292 
   90.2670008  -18.9677421   06h01m04.08s  -18d58m03.87s  59479.65408213   10.444      0.017   10.570      0.023        0.154751   191.676463 
   90.2670221  -18.9677415   06h01m04.09s  -18d58m03.87s  58747.84314155   10.816      0.016   10.925      0.023        0.154965   164.584620 
   90.2669986  -18.9677417   06h01m04.08s  -18d58m03.87s  59272.87123339   10.574      0.021   10.679      0.021        0.155056   194.495681 
   90.2670320  -18.9677381   06h01m04.09s  -18d58m03.86s  58383.56404984   10.807      0.016   10.888      0.024        0.156270   151.362172 
   90.2669638  -18.9677008   06h01m04.07s  -18d58m03.72s  59479.52330632   10.516      0.033    8.546      0.015        0.157324   268.951011 
   90.2670372  -18.9677362   06h01m04.09s  -18d58m03.85s  56735.13707435   10.811      0.016   10.889      0.023        0.159856   144.603065 
   90.2670209  -18.9677436   06h01m04.09s  -18d58m03.88s  58177.44705421   10.801      0.017   10.891      0.020        0.161297   166.698077 
   90.2670289  -18.9677412   06h01m04.09s  -18d58m03.87s  57094.32275711   10.782      0.017   10.872      0.021        0.161678   156.547393 
   90.2670076  -18.9677450   06h01m04.08s  -18d58m03.88s  57094.78244726   10.796      0.019   10.865      0.023        0.162203   182.887405 
   90.2669776  -18.9677335   06h01m04.07s  -18d58m03.84s  59479.13123341   10.448      0.015   10.542      0.018        0.163450   222.447559 
   90.2670495  -18.9677262   06h01m04.09s  -18d58m03.81s  57655.57814104   10.808      0.020   10.840      0.020        0.164257   125.044845 
   90.2670038  -18.9677456   06h01m04.08s  -18d58m03.88s  58177.57795854   10.814      0.017   10.885      0.020        0.165518   187.327017 
   90.2669890  -18.9677420   06h01m04.08s  -18d58m03.87s  58905.89566583   10.789      0.017   10.876      0.024        0.167249   205.307165 
   90.2669975  -18.9677451   06h01m04.08s  -18d58m03.88s  58751.31067579   10.801      0.017   10.894      0.025        0.167841   194.687528 
   90.2670403  -18.9677371   06h01m04.09s  -18d58m03.85s  58905.69943791   10.758      0.020   10.884      0.022        0.168768   142.318739 
   90.2670227  -18.9677454   06h01m04.09s  -18d58m03.88s  57652.56480637   10.818      0.018   10.912      0.023        0.169075   165.182054 
   90.2670254  -18.9677453   06h01m04.09s  -18d58m03.88s  58019.80348358   10.810      0.022   10.846      0.025        0.171296   162.177567 
   90.2669832  -18.9677403   06h01m04.08s  -18d58m03.87s  57652.76128941   10.814      0.016   10.897      0.024        0.171378   212.165925 
   90.2670002  -18.9677470   06h01m04.08s  -18d58m03.89s  57655.70917222   10.812      0.018   10.886      0.022        0.172450   191.154978 
   90.2670172  -18.9677477   06h01m04.08s  -18d58m03.89s  58541.53782398   10.802      0.016   10.925      0.022        0.173460   171.876058 
   90.2670360  -18.9677416   06h01m04.09s  -18d58m03.87s  58019.67245285   10.839      0.021   10.892      0.021        0.173977   149.414214 
   90.2670270  -18.9677457   06h01m04.09s  -18d58m03.88s  58541.86495440   10.801      0.018   10.905      0.023        0.174411   160.618498 
   90.2669588  -18.9676939   06h01m04.07s  -18d58m03.70s  57653.02335172   10.876      0.018   11.010      0.025        0.175679   277.180352 
   90.2670377  -18.9677413   06h01m04.09s  -18d58m03.87s  57817.77095435   10.813      0.016   10.904      0.020        0.176055   147.613690 
   90.2670036  -18.9677488   06h01m04.08s  -18d58m03.90s  57819.60462793   10.797      0.020   10.846      0.023        0.177018   187.070088 
   90.2670440  -18.9677374   06h01m04.09s  -18d58m03.85s  57652.82674132   10.829      0.022   10.871      0.023        0.177551   139.313403 
   90.2670351  -18.9677437   06h01m04.09s  -18d58m03.88s  58541.60327553   10.806      0.018   10.893      0.022        0.179035   151.489928 
   90.2670339  -18.9677446   06h01m04.09s  -18d58m03.88s  57656.16771763   10.784      0.018   10.926      0.024        0.180008   153.125141 
   90.2669751  -18.9677378   06h01m04.07s  -18d58m03.86s  57652.30274405   10.833      0.016   10.999      0.025        0.180663   221.125766 
   90.2670265  -18.9677482   06h01m04.09s  -18d58m03.89s  58912.63159551   10.809      0.022   10.891      0.021        0.182380   162.061363 
   90.2670316  -18.9677466   06h01m04.09s  -18d58m03.89s  56927.18228872   10.792      0.018   10.849      0.022        0.183182   156.329710 
   90.2670284  -18.9677479   06h01m04.09s  -18d58m03.89s  57288.47313873   10.821      0.016   10.883      0.021        0.183465   160.035142 
   90.2669976  -18.9677497   06h01m04.08s  -18d58m03.90s  57652.63025823   10.824      0.015   10.984      0.021        0.183825   193.276107 
   90.2670367  -18.9677449   06h01m04.09s  -18d58m03.88s  59115.60005149   10.732      0.017   10.843      0.022        0.185437   150.648078 
   90.2669915  -18.9677486   06h01m04.08s  -18d58m03.89s  57453.13750951   10.802      0.017   10.967      0.020        0.185946   199.798335 
   90.2669936  -18.9677497   06h01m04.08s  -18d58m03.90s  57093.92877337   10.816      0.020   10.895      0.023        0.187438   197.331186 
   90.2670227  -18.9677514   06h01m04.09s  -18d58m03.91s  57453.85849943   10.758      0.016   10.626      0.016        0.190016   166.847925 
   90.2670457  -18.9677414   06h01m04.09s  -18d58m03.87s  58541.66872709   10.768      0.019   10.914      0.020        0.192314   140.802882 
   90.2670385  -18.9677462   06h01m04.09s  -18d58m03.89s  58177.77431512   10.808      0.017   10.896      0.025        0.192560   149.741252 
   90.2670002  -18.9677529   06h01m04.08s  -18d58m03.91s  57655.84020340   10.817      0.017   10.857      0.020        0.193343   189.937150 
   90.2669860  -18.9677490   06h01m04.08s  -18d58m03.90s  59114.88072073   10.715      0.017   10.840      0.020        0.194415   204.853610 
   90.2670264  -18.9677520   06h01m04.09s  -18d58m03.91s  57453.72734097   10.784      0.018   10.902      0.020        0.195360   163.392276 
   90.2669958  -18.9677526   06h01m04.08s  -18d58m03.91s  57653.41631795   10.816      0.020   10.916      0.023        0.195433   194.321878 
   90.2670257  -18.9677524   06h01m04.09s  -18d58m03.91s  57656.29874881   10.828      0.017   10.875      0.024        0.196060   164.179946 
   90.2670276  -18.9677523   06h01m04.09s  -18d58m03.91s  57652.95777250   10.781      0.020   10.884      0.022        0.197596   162.346454 
   90.2669882  -18.9677517   06h01m04.08s  -18d58m03.91s  59115.01149661   10.751      0.018   10.871      0.020        0.200373   201.740522 
   90.2669648  -18.9677377   06h01m04.07s  -18d58m03.86s  56735.33457534   10.783      0.016   10.942      0.025        0.205195   228.589002 
   90.2670310  -18.9677553   06h01m04.09s  -18d58m03.92s  57820.06304627   10.822      0.024   10.893      0.021        0.211520   160.245406 
   90.2670009  -18.9677614   06h01m04.08s  -18d58m03.94s  59115.53409052   10.712      0.021   10.847      0.025        0.223211   187.978657 
   90.2670065  -18.9677629   06h01m04.08s  -18d58m03.95s  57289.12905726   10.801      0.017   10.830      0.022        0.226759   183.012269 
   90.2670316  -18.9677596   06h01m04.09s  -18d58m03.93s  56734.87373969   10.825      0.019   10.883      0.021        0.226821   161.081490 
   90.2670056  -18.9677640   06h01m04.08s  -18d58m03.95s  58905.63398617   10.814      0.018   10.835      0.024        0.230887   183.719963 
   90.2669945  -18.9677665   06h01m04.08s  -18d58m03.96s  58384.67647297   10.813      0.021   10.830      0.025        0.245156   192.430735 
   90.2670574  -18.9677553   06h01m04.09s  -18d58m03.92s  57652.69583750   10.834      0.021   10.957      0.024        0.256271   140.971730 
   90.2670651  -18.9677508   06h01m04.10s  -18d58m03.90s  57819.86656309   10.785      0.017   10.866      0.020        0.261977   134.271703 
   90.2670017  -18.9677809   06h01m04.08s  -18d58m04.01s  58541.73405128   10.756      0.022   10.872      0.021        0.292605   185.541777 
   90.2669410  -18.9676513   06h01m04.07s  -18d58m03.54s  57652.89232059   10.908      0.020   11.093      0.023        0.293121   306.734733 
   90.2670305  -18.9677835   06h01m04.09s  -18d58m04.02s  59479.45798206   10.469      0.015   10.587      0.021        0.308601   166.928760 
   90.2670206  -18.9675997   06h01m04.08s  -18d58m03.36s  58383.43314657   11.032      0.021   10.868      0.021        0.362878     5.707452 
   90.2669163  -18.9678336   06h01m04.06s  -18d58m04.20s  56926.78766851     null       null   10.798      0.020        0.577139   213.554919 
   90.2670029  -18.9678947   06h01m04.08s  -18d58m04.42s  57652.43377523   10.501      0.016   10.942      0.023        0.701337   181.975135 
   90.2668647  -18.9678702   06h01m04.05s  -18d58m04.33s  57819.93201503   10.643      0.019    6.068      0.009        0.787486   218.915537 
   90.2672496  -18.9677927   06h01m04.14s  -18d58m04.05s  58751.44157898   10.437      0.016   11.037      0.024        0.881348   112.249937 """

sample_response_no_coverage="""\                                                                               
\fixlen = T
\RowsRetrieved =                 0
\ORIGIN  = 'IPAC Infrared Science Archive (IRSA), Caltech/JPL'
\SIMULATED_TABLE  = 'n'
\DATETIME= '2022-11-21 04:18:28'
\DataTag = 'ADS/IRSA.Gator#2022/1121/041828_10255'
\DATABASE= 'NEOWISE-R Single Exposure (L1b) Source Table (neowiser_p1bs_psd)'
\EQUINOX = 'J2000'
\SKYAREA = 'within 0.1 arcsec of  ra=0.00000 dec=+0.00000 Eq J2000 '
\StatusFile = '/workspace/TMP_4R2A1g_10255/Gator/irsa/10255/log.10255.html'
\SQL     = 'WHERE (no constraints) 
\SQL     = 'SELECT (9 column names follow in next row.)'
\ 
\ ra (deg) 
\ ___ right ascension (J2000)
\ dec (deg) 
\ ___ declination (J2000)
\ clon 
\ ___ Right ascention in Sexagesimal format.
\ clat 
\ ___ Declination in Sexagesimal format.
\ mjd (mjdate) 
\ ___ modified Julian date of the mid-point of the observation of the frame
\ w1mpro (mag) 
\ ___ instrumental profile-fit photometry magnitude, band 1
\ w1sigmpro (mag) 
\ ___ instrumental profile-fit photometry flux uncertainty in mag units, band 1
\ w2mpro (mag) 
\ ___ instrumental profile-fit photometry magnitude, band 2
\ w2sigmpro (mag) 
\ ___ instrumental profile-fit photometry flux uncertainty in mag units, band 2
\ dist (arcsec) 
\ ___ Distance between the target position and each source in arcsec.
\ angle (deg) 
\ ___ Position Angle in degree.
\ 
|          ra|         dec|          clon|          clat|            mjd|  w1mpro| w1sigmpro|  w2mpro| w2sigmpro|           dist|       angle|
|      double|      double|          char|          char|         double|  double|    double|  double|    double|         double|      double|
|         deg|         deg|              |              |         mjdate|     mag|       mag|     mag|       mag|         arcsec|         deg|
|        null|        null|          null|          null|           null|    null|      null|    null|      null|           null|        null|
"""

def create_sample_target() -> Target:
    target: Target = Target(
        name="Gaia20fnr",
        ra=Decimal(90.2670097),
        dec=Decimal(-18.967703),
        type='SIDEREAL',
        epoch=2000,
    )

    target.save()
    TargetName.objects.create(target=target, source_name=DataSource.GAIA.name, name='Gaia20fnr')

    return target


def create_second_sample_target() -> Target:
    target: Target = Target(
        name="GaiaXXX",
        ra=Decimal(95.2670097),
        dec=Decimal(-20.967703),
        type='SIDEREAL',
        epoch=2000,
    )

    target.save(names={DataSource.GAIA.name: "GaiaXXX"})

    return target


class NEOWISELightcurveUpdateTestCase(TestCase):
    
    @patch('bhtom2.brokers.neowise.query_external_service',
           return_value=sample_response)
    def test_update_neowise_with_coverage(self, _):

        neowise_broker: NEOWISEBroker = NEOWISEBroker()

        target: Target = Target(
            name="Gaia20fnr",
            ra=Decimal(90.2670097),
            dec=Decimal(-18.967703),
            type='SIDEREAL',
            epoch=2000,
        )

        target.save()

        report: LightcurveUpdateReport = neowise_broker.process_reduced_data(target)

        rd: List[ReducedDatum] = list(ReducedDatum.objects.all())

        print("TESTRD",rd)

        self.assertEqual(len(rd), 561)
        self.assertEqual(report.new_points, 562)

    
    @patch('bhtom2.brokers.neowise.query_external_service',
           return_value=sample_response_no_coverage)
    def test_update_neowise_no_coverage(self, _):

        neowise_broker: NEOWISEBroker = NEOWISEBroker()

        target: Target = Target(
            name="Gaia21een",
            ra=Decimal(113.25287),
            dec=Decimal(-31.98319),
            type='SIDEREAL',
            epoch=2000,
        )

        target.save()

        report: LightcurveUpdateReport = neowise_broker.process_reduced_data(target)

        rd: List[ReducedDatum] = list(ReducedDatum.objects.all())

        self.assertEqual(len(rd), 0)
        self.assertEqual(report.new_points, 0)
